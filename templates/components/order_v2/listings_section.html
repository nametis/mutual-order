<!-- My Discs Section -->
<div x-show="myListings.length > 0" class="bg-white rounded-lg shadow p-4 sm:p-6 mt-6">
    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3 mb-4">
        <h3 class="flex items-center space-x-2 text-lg sm:text-xl font-bold text-gray-900">
            <span class="bg-yellow-100 px-3 py-1 rounded-full">
                <span>ðŸ’¿</span>
                <span>Mes disques</span>
            </span>
        </h3>
        <button x-show="order.status === 'building'" @click="verifyAvailability()"
                class="flex items-center space-x-1 px-3 py-1 border border-dashed border-gray-400 rounded-full text-gray-600 hover:bg-gray-50 text-xs transition-colors self-start">
            <span>ðŸ”„</span>
            <span>VÃ©rifier dispo</span>
        </button>
    </div>
    
    <!-- Mobile: Card Layout -->
    <div class="block sm:hidden space-y-3">
        <template x-for="listing in myListings" :key="listing.id + '_mobile'">
            <div class="border border-gray-200 rounded-lg p-4">
                <div class="flex items-start space-x-3">
                    <!-- Image -->
                    <img x-show="listing.image_url" :src="listing.image_url" 
                         class="w-16 h-16 object-cover rounded flex-shrink-0">
                    <div x-show="!listing.image_url" 
                         class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center flex-shrink-0">
                        <span class="text-gray-400">?</span>
                    </div>
                    
                    <!-- Content -->
                    <div class="flex-1 min-w-0">
                        <div class="font-medium text-gray-900 mb-1" x-text="listing.title"></div>
                        <div class="text-sm text-gray-500 mb-2" x-text="'ID: ' + listing.discogs_id"></div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-lg font-bold text-gray-900" x-text="listing.price_value.toFixed(2) + 'â‚¬'"></span>
                            <div class="flex items-center space-x-1">
                                <a :href="listing.listing_url" target="_blank"
                                   class="p-2 text-gray-600 rounded-full hover:bg-gray-100 transition-colors"
                                   title="Voir sur Discogs">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" />
                                        <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" />
                                    </svg>
                                </a>
                                <button x-show="order.status === 'building'" @click="removeListing(listing.id)"
                                        class="p-2 text-red-600 rounded-full hover:bg-red-100 transition-colors"
                                        title="Retirer le disque">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Condition badges for mobile -->
                        <div class="flex space-x-2">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                  :class="getConditionClass(listing.media_condition)"
                                  x-text="'V: ' + getShortCondition(listing.media_condition)"></span>
                            <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                  :class="getConditionClass(listing.sleeve_condition)"
                                  x-text="'P: ' + getShortCondition(listing.sleeve_condition)"></span>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </div>
    
    <!-- Desktop: Simplified Table -->
    <div class="hidden sm:block">
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <table class="min-w-full">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Pochette</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Titre</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Prix</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ã‰tats</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    <template x-for="listing in myListings" :key="listing.id + '_desktop'">
                        <tr>
                            <td class="px-6 py-4">
                                <img x-show="listing.image_url" :src="listing.image_url" 
                                     class="w-16 h-16 object-cover rounded">
                                <div x-show="!listing.image_url" 
                                     class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center">
                                    <span class="text-gray-400">?</span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="font-medium text-gray-900" x-text="listing.title"></div>
                                <div class="text-sm text-gray-500" x-text="'ID: ' + listing.discogs_id"></div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-900 font-medium" x-text="listing.price_value.toFixed(2) + 'â‚¬'"></td>
                            <td class="px-6 py-4">
                                <div class="flex flex-col space-y-1">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                          :class="getConditionClass(listing.media_condition)"
                                          x-text="'V: ' + getShortCondition(listing.media_condition)"></span>
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                          :class="getConditionClass(listing.sleeve_condition)"
                                          x-text="'P: ' + getShortCondition(listing.sleeve_condition)"></span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="flex items-center space-x-2">
                                    <a :href="listing.listing_url" target="_blank"
                                       class="p-2 text-gray-600 rounded-full hover:bg-gray-100 transition-colors"
                                       title="Voir sur Discogs">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                            <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" />
                                            <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" />
                                        </svg>
                                    </a>
                                    <button x-show="order.status === 'building'" @click="removeListing(listing.id)"
                                            class="p-2 text-red-600 rounded-full hover:bg-red-100 transition-colors"
                                            title="Retirer le disque">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Other Discs Section -->
<div x-show="otherListings.length > 0" class="bg-white rounded-lg shadow p-4 sm:p-6 mt-6">
    <div class="flex items-center justify-between mb-4">
        <h3 class="flex items-center space-x-2 text-lg sm:text-xl font-bold text-gray-900">
            <span class="bg-yellow-100 px-3 py-1 rounded-full">
                <span>ðŸŽµ</span>
                <span>Les autres disques dans la commande</span>
            </span>
        </h3>
    </div>
    
    <!-- Mobile: Card Layout -->
    <div class="block sm:hidden space-y-3">
        <template x-for="listing in otherListings" :key="listing.id + '_mobile'">
            <div class="border border-gray-200 rounded-lg p-4">
                <div class="flex items-start space-x-3">
                    <!-- Image -->
                    <img x-show="listing.image_url" :src="listing.image_url" 
                         class="w-16 h-16 object-cover rounded flex-shrink-0">
                    <div x-show="!listing.image_url" 
                         class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center flex-shrink-0">
                        <span class="text-gray-400">?</span>
                    </div>
                    
                    <!-- Content -->
                    <div class="flex-1 min-w-0">
                        <div class="font-medium text-gray-900 mb-1" x-text="listing.title"></div>
                        <div class="text-sm text-gray-500 mb-1" x-text="'ID: ' + listing.discogs_id"></div>
                        <div class="text-sm text-gray-600 mb-2" x-text="'Par: ' + listing.username"></div>
                        <div class="flex items-center justify-between mb-2">
                            <span class="text-lg font-bold text-gray-900" x-text="listing.price_value.toFixed(2) + 'â‚¬'"></span>
                            <div class="flex items-center space-x-1">
                                <a :href="listing.listing_url" target="_blank"
                                   class="p-2 text-gray-600 rounded-full hover:bg-gray-100 transition-colors"
                                   title="Voir sur Discogs">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" />
                                        <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" />
                                    </svg>
                                </a>
                                <button x-show="order.status === 'building' && (listing.user_id === currentUserId || order.creator_id === currentUserId || isAdmin)" 
                                        @click="removeListing(listing.id)"
                                        class="p-2 text-red-600 rounded-full hover:bg-red-100 transition-colors"
                                        title="Retirer le disque">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                        <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <!-- Condition badges for mobile -->
                        <div class="flex space-x-2">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                  :class="getConditionClass(listing.media_condition)"
                                  x-text="'V: ' + getShortCondition(listing.media_condition)"></span>
                            <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                  :class="getConditionClass(listing.sleeve_condition)"
                                  x-text="'P: ' + getShortCondition(listing.sleeve_condition)"></span>
                        </div>
                    </div>
                </div>
            </div>
        </template>
    </div>
    
    <!-- Desktop: Simplified Table -->
    <div class="hidden sm:block">
        <div class="bg-white rounded-lg shadow overflow-hidden">
            <table class="min-w-full">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Pochette</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Titre</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Prix</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Ã‰tats</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">AjoutÃ© par</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    <template x-for="listing in otherListings" :key="listing.id + '_desktop'">
                        <tr>
                            <td class="px-6 py-4">
                                <img x-show="listing.image_url" :src="listing.image_url" 
                                     class="w-16 h-16 object-cover rounded">
                                <div x-show="!listing.image_url" 
                                     class="w-16 h-16 bg-gray-100 rounded flex items-center justify-center">
                                    <span class="text-gray-400">?</span>
                                </div>
                            </td>
                            <td class="px-6 py-4">
                                <div class="font-medium text-gray-900" x-text="listing.title"></div>
                                <div class="text-sm text-gray-500" x-text="'ID: ' + listing.discogs_id"></div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-900 font-medium" x-text="listing.price_value.toFixed(2) + 'â‚¬'"></td>
                            <td class="px-6 py-4">
                                <div class="flex flex-col space-y-1">
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                          :class="getConditionClass(listing.media_condition)"
                                          x-text="'V: ' + getShortCondition(listing.media_condition)"></span>
                                    <span class="px-2 py-1 text-xs font-semibold rounded-full"
                                          :class="getConditionClass(listing.sleeve_condition)"
                                          x-text="'P: ' + getShortCondition(listing.sleeve_condition)"></span>
                                </div>
                            </td>
                            <td class="px-6 py-4 text-sm text-gray-900" x-text="listing.username"></td>
                            <td class="px-6 py-4">
                                <div class="flex items-center space-x-2">
                                    <a :href="listing.listing_url" target="_blank"
                                       class="p-2 text-gray-600 rounded-full hover:bg-gray-100 transition-colors"
                                       title="Voir sur Discogs">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                            <path d="M11 3a1 1 0 100 2h2.586l-6.293 6.293a1 1 0 101.414 1.414L15 6.414V9a1 1 0 102 0V4a1 1 0 00-1-1h-5z" />
                                            <path d="M5 5a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-3a1 1 0 10-2 0v3H5V7h3a1 1 0 000-2H5z" />
                                        </svg>
                                    </a>
                                    <button x-show="order.status === 'building' && (listing.user_id === currentUserId || order.creator_id === currentUserId || isAdmin)" 
                                            @click="removeListing(listing.id)"
                                            class="p-2 text-red-600 rounded-full hover:bg-red-100 transition-colors"
                                            title="Retirer le disque">
                                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                                            <path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm6 0a1 1 0 11-2 0v6a1 1 0 112 0V8z" clip-rule="evenodd" />
                                        </svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </template>
                </tbody>
            </table>
        </div>
    </div>
</div>